<header>
  <h1>Administracion de Productos</h1>
  <nav>
    {{#if user}}
    <p>Bienvenido, {{user.email}}</p>
    <a class="btn btn-primary mb-3" href="/">Catalogo</a>
    <a class="btn btn-primary mb-3" href="/profile">Mi perfil</a>
    <a class="btn btn-primary mb-3" href="/logout">Cerrar sesion</a>
    {{/if}}
  </nav>
</header>
<main>
  <section>
    <h1>Nuevo Producto</h1>

    <form action="/admin/create" method="POST">
      <!-- Formulario para crear un producto nuevo -->
      <div class="mb-3">
        <label class="form-label">Nombre</label>
        <input name="name" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Categoría</label>
        <input name="category" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Descripción</label>
        <textarea name="description" class="form-control"></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label">Imagen (URL)</label>
        <input name="image" class="form-control" placeholder="https://...">
      </div>

      <div class="mb-3">
        <label class="form-label">Precio</label>
        <input type="number" step="0.01" name="price" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Oferta</label>
        <input type="number" step="0.01" name="offer" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Stock</label>
        <input type="number" name="stock" class="form-control" value="0">
      </div>

      <button class="btn btn-success">Guardar Producto</button>
    </form>
  </section>


  <section>
    <h2>Lista de Productos</h2>

    <a href="/admin/">Todas</a>
    {{#each categories}}
    <a href="/admin/?category={{this}}" {{#if (eq ../category this)}}style="font-weight: bold;" {{/if}}>
      {{this}}
    </a>
    {{/each}}

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Categoría</th>
          <th>Descripción</th>
          <th>Imagen</th>
          <th>Precio</th>
          <th>Oferta</th>
          <th>Stock</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {{#each products}}
        <tr>
          <form action="/admin/update/{{this._id}}" method="POST">
            <td>
              <input type="text" name="name" value="{{this.name}}" class="form-control" required>
            </td>
            <td>
              <input type="text" name="category" value="{{this.category}}" class="form-control" required>
            </td>
            <td>
              <input type="text" name="description" value="{{this.description}}" class="form-control">
            </td>
            <td>
              <input type="text" name="image" value="{{this.image}}" class="form-control" placeholder="https://...">
            </td>
            <td>
              <input type="number" step="0.01" name="price" value="{{this.price}}" class="form-control" required>
            </td>
            <td>
              <input type="number" step="0.01" name="offer" value="{{this.offer}}" class="form-control" required>
            </td>
            <td>
              <input type="number" name="stock" value="{{this.stock}}" class="form-control" required>
            </td>
            <td>
              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-warning btn-sm">Actualizar</button>
          </form>
          <form action="/admin/delete/{{this._id}}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
          </form>
          </div>
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </section>
</main>