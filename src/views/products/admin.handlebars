<header>
  <div class="header-logo"></div>
  {{#if user}}
  <div class="user-info">
    <p>Bienvenido, {{user.email}}</p>
    <a class="btn btn-warning btn-sm" href="/profile">Mi perfil</a>
    <a class="btn btn-danger btn-sm" href="/logout">Cerrar sesión</a>
  </div>
  {{/if}}
  <div class="content-column">
    <div class="header-top">
      <h1>Gestion de Productos</h1>
    </div>
    <div class="category-buttons">
      <a class="btn btn-warning" href="/">Catalogo</a>
      <a class="btn btn-danger" href="/admin">Administración</a>
    </div>
  </div>
</header>
<main>
  <section>
    <h1>Nuevo Producto</h1>

    <form action="/admin/create" method="POST">
      <div class="mb-2">
        <label class="form-label">Nombre</label>
        <input name="name" class="form-control" required>
      </div>

      <div class="mb-2">
        <label class="form-label">Categoría</label>
        <input name="category" class="form-control" required>
      </div>

      <div class="mb-2">
        <label class="form-label">Descripción</label>
        <textarea name="description" class="form-control" required></textarea>
      </div>

      <div class="mb-2">
        <label class="form-label">Imagen (URL)</label>
        <input type="url" name="image" class="form-control" placeholder="https://..." required>
      </div>

      <div class="mb-2">
        <label class="form-label">Precio</label>
        <input type="number" step="0.01" name="price" class="form-control" required>
      </div>

      <div class="mb-2">
        <label class="form-label">Oferta</label>
        <input type="number" step="0.01" name="offer" class="form-control" required>
      </div>

      <div class="mb-2">
        <label class="form-label">Stock</label>
        <input type="number" name="stock" class="form-control" value="0">
      </div>

      <button class="btn btn-success mt-2">Guardar Producto</button>
    </form>

  </section>


  <section>
    <h2>Lista de Productos</h2>

    <a class="btn btn-warning btn-sm" href="/admin/">Todos</a>
    {{#each categories}}
    <a class="btn btn-warning btn-sm" href="/admin/?category={{this}}" {{#if (eq ../category
      this)}}style="font-weight: bold;" {{/if}}>
      {{this}}
    </a>
    {{/each}}

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Categoría</th>
          <th>Descripción</th>
          <th>Imagen</th>
          <th>Precio</th>
          <th>Oferta</th>
          <th>Stock</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {{#each products}}
        <tr>
          <form action="/admin/update/{{this._id}}" method="POST">
            <td>
              <input type="text" name="name" value="{{this.name}}" class="form-control" required>
            </td>
            <td>
              <input type="text" name="category" value="{{this.category}}" class="form-control" required>
            </td>
            <td>
              <input type="text" name="description" value="{{this.description}}" class="form-control">
            </td>
            <td>
              <input type="text" name="image" value="{{this.image}}" class="form-control" placeholder="https://...">
            </td>
            <td>
              <input type="number" step="0.01" name="price" value="{{this.price}}" class="form-control" required>
            </td>
            <td>
              <input type="number" step="0.01" name="offer" value="{{this.offer}}" class="form-control" required>
            </td>
            <td>
              <input type="number" name="stock" value="{{this.stock}}" class="form-control" required>
            </td>
            <td>
              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-success btn-sm">Actualizar</button>
          </form>
          <form action="/admin/delete/{{this._id}}" method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
          </form>
          </div>
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </section>
</main>